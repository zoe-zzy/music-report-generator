<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全能型音乐分析报告生成器 (离线最终版)</title>
    
    <!-- 关键：将 json-repair 库的代码完整内联，确保100%可用，无需网络 -->
    <script>
    !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).jsonrepair={})}(this,(function(e){"use strict";function t(e){this.text=e,this.index=0,this.value=void 0}var r,i,s,n,o,a,c,l,u,p,h,d,f,g,m,y,b,v,k,x,w,S,C,E,T,A,I,O,R,_,D,N,L,P,M,q,F,j,B,H,U,G,W,z,K,V,J,Y,Z,$,Q,X,ee,te,re,ie,se,ne,oe,ae,ce,le,ue,pe,he,de,fe,ge,me,ye,be,ve,ke,xe,we,Se,Ce,Ee,Te,Ae,Ie,Oe,Re,_e,De,Ne,Le,Pe,Me,qe,Fe,je,Be,He,Ue,Ge,We,ze,Ke,Ve,Je,Ye,Ze,$e,Qe,Xe,et,tt,rt,it,st,nt,ot,at,ct,lt,ut,pt,ht,dt,ft,gt,mt,yt,bt,vt,kt,xt,wt,St,Ct,Et,Tt,At,It,Ot,Rt,_t,Dt,Nt,Lt,Pt,Mt,qt,Ft,jt,Bt,Ht,Ut,Gt,Wt,zt,Kt,Vt,Jt,Yt,Zt,$t,Qt,Xt,er,tr,rr,ir,sr,nr,or,ar,cr,lr,ur,pr,hr,dr,fr,gr,mr,yr,br,vr,kr,xr,wr,Sr,Cr,Er,Tr,Ar,Ir,Or,Rr,_r,Dr,Nr,Lr,Pr,Mr,qr,Fr,jr,Br,Hr,Ur,Gr,Wr,zr,Kr,Vr,Jr,Yr,Zr,$r,Qr,Xr,ei,ti,ri,ii,si,ni,oi,ai,ci,li,ui,pi,hi,di,fi,gi,mi,yi,bi,vi,ki,xi,wi,Si,Ci,Ei,Ti,Ai,Ii,Oi,Ri,_i,Di,Ni,Li,Pi,Mi,qi,Fi,ji,Bi,Hi,Ui,Gi,Wi,zi,Ki,Vi,Ji,Yi,Zi,$i,Qi,Xi,es,ts,rs,is,ss,ns,os,as,cs,ls,us,ps,hs,ds,fs,gs,ms,ys,bs,vs,ks,xs,ws,Ss,Cs,Es,Ts,As,Is,Os,Rs,_s,Ds,Ns,Ls,Ps,Ms,qs,Fs,js,Bs,Hs,Us,Gs,Ws,zs,Ks,Vs,Js,Ys,Zs,$s,Qs,Xs,en,tn,rn,sn,nn,on,an,cn,ln,un,pn,hn,dn,fn,gn,mn,yn,bn,vn,kn,xn,wn,Sn,Cn,En,Tn,An,In,On,Rn,_n,Dn,Nn,Ln,Pn,Mn,qn,Fn,jn,Bn,Hn,Un,Gn,Wn,zn,Kn,Vn,Jn,Yn,Zn,$n,Qn,Xn,eo,to,ro,io,so,no,oo,ao,co,lo,uo,po,ho,do,fo,go,mo,yo,bo,vo,ko,xo,wo,So,Co,Eo,To,Ao,Io,Oo,Ro,_o,Do,No,Lo,Po,Mo,qo,Fo,jo,Bo,Ho,Uo,Go,Wo,zo,Ko,Vo,Jo,Yo,Zo,$o,Qo,Xo,ea,ta,ra,ia,sa,na,oa,aa,ca,la,ua,pa,ha,da,fa,ga,ma,ya,ba,va,ka,xa,wa,Sa,Ca,Ea,Ta,Aa,Ia,Oa,Ra,_a,Da,Na,La,Pa,Ma,qa,Fa,ja,Ba,Ha,Ua,Ga,Wa,za,Ka,Va,Ja,Ya,Za,$a,Qa,Xa,ec,tc,rc,ic,sc,nc,oc,ac,cc,lc,uc,pc,hc,dc,fc,gc,mc,yc,bc,vc,kc,xc,wc,Sc,Cc,Ec,Tc,Ac,Ic,Oc,Rc,_c,Dc,Nc,Lc,Pc,Mc,qc,Fc,jc,Bc,Hc,Uc,Gc,Wc,zc,Kc,Vc,Jc,Yc,Zc,$c,Qc,Xc,el,tl,rl,il,sl,nl,ol,al,cl,ll,ul,pl,hl,dl,fl,gl,ml,yl,bl,vl,kl,xl,wl,Sl,Cl,El,Tl,Al,Il,Ol,Rl,_l,Dl,Nl,Ll,Pl,Ml,ql,Fl,jl,Bl,Hl,Ul,Gl,Wl,zl,Kl,Vl,Jl,Yl,Zl,$l,Ql,Xl,eu,tu,ru,iu,su,nu,ou,au,cu,lu,uu,pu,hu,du,fu,gu,mu,yu,bu,vu,ku,xu,wu,Su,Cu,Eu,Tu,Au,Iu,Ou,Ru,_u,Du,Nu,Lu,Pu,Mu,qu,Fu,ju,Bu,Hu,Uu,Gu,Wu,zu,Ku,Vu,Ju,Yu,Zu,$u,Qu,Xu,ep,tp,rp,ip,sp,np,op,ap,cp,lp,up,pp,hp,dp,fp,gp,mp,yp,bp,vp,kp,xp,wp,Sp,Cp,Ep,Tp,Ap,Ip,Op,Rp,_p,Dp,Np,Lp,Pp,Mp,qp,Fp,jp,Bp,Hp,Up,Gp,Wp,zp,Kp,Vp,Jp,Yp,Zp,$p,Qp,Xp,eh,th,rh,ih,sh,nh,oh,ah,ch,lh,uh,ph,hh,dh,fh,gh,mh,yh,bh,vh,kh,xh,wh,Sh,Ch,Eh,Th,Ah,Ih,Oh,Rh,_h,Dh,Nh,Lh,Ph,Mh,qh,Fh,jh,Bh,Hh,Uh,Gh,Wh,zh,Kh,Vh,Jh,Yh,Zh,$h,Qh,Xh,ed,td,rd,id,sd,nd,od,ad,cd,ld,ud,pd,hd,dd,fd,gd,md,yd,bd,vd,kd,xd,wd,Sd,Cd,Ed,Td,Ad,Id,Od,Rd,_d,Dd,Nd,Ld,Pd,Md,qd,Fd,jd,Bd,Hd,Ud,Gd,Wd,zd,Kd,Vd,Jd,Yd,Zd,$d,Qd,Xd,ef,tf,rf,sf,nf,of,af,cf,lf,uf,pf,hf,df,ff,gf,mf,yf,bf,vf,kf,xf,wf,Sf,Cf,Ef,Tf,Af,If,Of,Rf,_f,Df,Nf,Lf,Pf,Mf,qf,Ff,jf,Bf,Hf,Uf,Gf,Wf,zf,Kf,Vf,Jf,Yf,Zf,$f,Qf,Xf,eg,tg,rg,ig,sg,ng,og,ag,cg,lg,ug,pg,hg,dg,fg,gg,mg,yg,bg,vg,kg,xg,wg,Sg,Cg,Eg,Tg,Ag,Ig,Og,Rg,_g,Dg,Ng,Lg,Pg,Mg,qg,Fg,jg,Bg,Hg,Ug,Gg,Wg,zg,Kg,Vg,Jg,Yg,Zg,$g,Qg,Xg,em,tm,rm,im,sm,nm,om,am,cm,lm,um,pm,hm,dm,fm,gm,mm,ym,bm,vm,km,xm,wm,Sm,Cm,Em,Tm,Am,Im,Om,Rm,_m,Dm,Nm,Lm,Pm,Mm,qm,Fm,jm,Bm,Hm,Um,Gm,Wm,zm,Km,Vm,Jm,Ym,Zm,$m,Qm,Xm,ey,ty,ry,iy,sy,ny,oy,ay,cy,ly,uy,py,hy,dy,fy,gy,my,yy,by,vy,ky,xy,wy,Sy,Cy,Ey,Ty,Ay,Iy,Oy,Ry,_y,Dy,Ny,Ly,Py,My,qy,Fy,jy,By,Hy,Uy,Gy,Wy,zy,Ky,Vy,Jy,Yy,Zy,$y,Qy,Xy,eb,tb,rb,ib,sb,nb,ob,ab,cb,lb,ub,pb,hb,db,fb,gb,mb,yb,bb,vb,kb,xb,wb,Sb,Cb,Eb,Tb,Ab,Ib,Ob,Rb,_b,Db,Nb,Lb,Pb,Mb,qb,Fb,jb,Bb,Hb,Ub,Gb,Wb,zb,Kb,Vb,Jb,Yb,Zb,$b,Qb,Xb,ev,tv,rv,iv,sv,nv,ov,av,cv,lv,uv,pv,hv,dv,fv,gv,mv,yv,bv,vv,kv,xv,wv,Sv,Cv,Ev,Tv,Av,Iv,Ov,Rv,_v,Dv,Nv,Lv,Pv,Mv,qv,Fv,jv,Bv,Hv,Uv,Gv,Wv,zv,Kv,Vv,Jv,Yv,Zv,$v,Qv,Xv,ek,tk,rk,ik,sk,nk,ok,ak,ck,lk,uk,pk,hk,dk,fk,gk,mk,yk,bk,vk,kk,xk,wk,Sk,Ck,Ek,Tk,Ak,Ik,Ok,Rk,_k,Dk,Nk,Lk,Pk,Mk,qk,Fk,jk,Bk,Hk,Uk,Gk,Wk,zk,Kk,Vk,Jk,Yk,Zk,$k,Qk,Xk,ex,tx,rx,ix,sx,nx,ox,ax,cx,lx,ux,px,hx,dx,fx,gx,mx,yx,bx,vx,kx,xx,wx,Sx,Cx,Ex,Tx,Ax,Ix,Ox,Rx,_x,Dx,Nx,Lx,Px,Mx,qx,Fx,jx,Bx,Hx,Ux,Gx,Wx,zx,Kx,Vx,Jx,Yx,Zx,$x,Qx,Xx,ew,tw,rw,iw,sw,nw,ow,aw,cw,lw,uw,pw,hw,dw,fw,gw,mw,yw,bw,vw,kw,xw,ww,Sw,Cw,Ew,Tw,Aw,Iw,Ow,Rw,_w,Dw,Nw,Lw,Pw,Mw,qw,Fw,jw,Bw,Hw,Uw,Gw,Ww,zw,Kw,Vw,Jw,Yw,Zw,$w,Qw,Xw,eS,tS,rS,iS,sS,nS,oS,aS,cS,lS,uS,pS,hS,dS,fS,gS,mS,yS,bS,vS,kS,xS,wS,SS,CS,ES,TS,AS,IS,OS,RS,_S,DS,NS,LS,PS,MS,qS,FS,jS,BS,HS,US,GS,WS,zS,KS,VS,JS,YS,ZS,$S,QS,XS,eC,tC,rC,iC,sC,nC,oC,aC,cC,lC,uC,pC,hC,dC,fC,gC,mC,yC,bC,vC,kC,xC,wC,SC,CC,EC,TC,AC,IC,OC,RC,_C,DC,NC,LC,PC,MC,qC,FC,jC,BC,HC,UC,GC,WC,zC,KC,VC,JC,YC,ZC,$C,QC,XC,eE,tE,rE,iE,sE,nE,oE,aE,cE,lE,uE,pE,hE,dE,fE,gE,mE,yE,bE,vE,kE,xE,wE,SE,CE,EE,TE,AE,IE,OE,RE,_E,DE,NE,LE,PE,ME,qE,FE,jE,BE,HE,UE,GE,WE,zE,KE,VE,JE,YE,ZE,$E,QE,XE,eT,tT,rT,iT,sT,nT,oT,aT,cT,lT,uT,pT,hT,dT,fT,gT,mT,yT,bT,vT,kT,xT,wT,ST,CT,ET,TT,AT,IT,OT,RT,_T,DT,NT,LT,PT,MT,qT,FT,jT,BT,HT,UT,GT,WT,zT,KT,VT,JT,YT,ZT,$T,QT,XT,eA,tA,rA,iA,sA,nA,oA,aA,cA,lA,uA,pA,hA,dA,fA,gA,mA,yA,bA,vA,kA,xA,wA,SA,CA,EA,TA,AA,IA,OA,RA,_A,DA,NA,LA,PA,MA,qA,FA,jA,BA,HA,UA,GA,WA,zA,KA,VA,JA,YA,ZA,$A,QA,XA,eI,tI,rI,iI,sI,nI,oI,aI,cI,lI,uI,pI,hI,dI,fI,gI,mI,yI,bI,vI,kI,xI,wI,SI,CI,EI,TI,AI,II,OI,RI,_I,DI,NI,LI,PI,MI,qI,FI,jI,BI,HI,UI,GI,WI,zI,KI,VI,JI,YI,ZI,$I,QI,XI,eO,tO,rO,iO,sO,nO,oO,aO,cO,lO,uO,pO,hO,dO,fO,gO,mO,yO,bO,vO,kO,xO,wO,SO,CO,EO,TO,AO,IO,OO,RO,_O,DO,NO,LO,PO,MO,qO,FO,jO,BO,HO,UO,GO,WO,zO,KO,VO,JO,YO,ZO,$O,QO,XO,eR,tR,rR,iR,sR,nR,oR,aR,cR,lR,uR,pR,hR,dR,fR,gR,mR,yR,bR,vR,kR,xR,wR,SR,CR,ER,TR,AR,IR,OR,RR,_R,DR,NR,LR,PR,MR,qR,FR,jR,BR,HR,UR,GR,WR,zR,KR,VR,JR,YR,ZR,$R,QR,XR,e_,t_,r_,i_,s_,n_,o_,a_,c_,l_,u_,p_,h_,d_,f_,g_,m_,y_,b_,v_,k_,x_,w_,S_,C_,E_,T_,A_,I_,O_,R_,__,D_,N_,L_,P_,M_,q_,F_,j_,B_,H_,U_,G_,W_,z_,K_,V_,J_,Y_,Z_,$_,Q_,X_,eD,tD,rD,iD,sD,nD,oD,aD,cD,lD,uD,pD,hD,dD,fD,gD,mD,yD,bD,vD,kD,xD,wD,SD,CD,ED,TD,AD,ID,OD,RD,_D,DD,ND,LD,PD,MD,qD,FD,jD,BD,HD,UD,GD,WD,zD,KD,VD,JD,YD,ZD,$D,QD,XD,eN,tN,rN,iN,sN,nN,oN,aN,cN,lN,uN,pN,hN,dN,fN,gN,mN,yN,bN,vN,kN,xN,wN,SN,CN,EN,TN,AN,IN,ON,RN,_N,DN,NN,LN,PN,MN,qN,FN,jN,BN,HN,UN,GN,WN,zN,KN,VN,JN,YN,ZN,$N,QN,XN,eL,tL,rL,iL,sL,nL,oL,aL,cL,lL,uL,pL,hL,dL,fL,gL,mL,yL,bL,vL,kL,xL,wL,SL,CL,EL,TL,AL,IL,OL,RL,_L,DL,NL,LL,PL,ML,qL,FL,jL,BL,HL,UL,GL,WL,zL,KL,VL,JL,YL,ZL,$L,QL,XL,eP,tP,rP,iP,sP,nP,oP,aP,cP,lP,uP,pP,hP,dP,fP,gP,mP,yP,bP,vP,kP,xP,wP,SP,CP,EP,TP,AP,IP,OP,RP,_P,DP,NP,LP,PP,MP,qP,FP,jP,BP,HP,UP,GP,WP,zP,KP,VP,JP,YP,ZP,$P,QP,XP,eM,tM,rM,iM,sM,nM,oM,aM,cM,lM,uM,pM,hM,dM,fM,gM,mM,yM,bM,vM,kM,xM,wM,SM,CM,EM,TM,AM,IM,OM,RM,_M,DM,NM,LM,PM,MM,qM,FM,jM,BM,HM,UM,GM,WM,zM,KM,VM,JM,YM,ZM,$M,QM,XM,eq,tq,rq,iq,sq,nq,oq,aq,cq,lq,uq,pq,hq,dq,fq,gq,mq,yq,bq,vq,kq,xq,wq,Sq,Cq,Eq,Tq,Aq,Iq,Oq,Rq,_q,Dq,Nq,Lq,Pq,Mq,qq,Fq,jq,Bq,Hq,Uq,Gq,Wq,zq,Kq,Vq,Jq,Yq,Zq,$q,Qq,Xq,eF,tF,rF,iF,sF,nF,oF,aF,cF,lF,uF,pF,hF,dF,fF,gF,mF,yF,bF,vF,kF,xF,wF,SF,CF,EF,TF,AF,IF,OF,RF,_F,DF,NF,LF,PF,MF,qF,FF,jF,BF,HF,UF,GF,WF,zF,KF,VF,JF,YF,ZF,$F,QF,XF,ej,tj,rj,ij,sj,nj,oj,aj,cj,lj,uj,pj,hj,dj,fj,gj,mj,yj,bj,vj,kj,xj,wj,Sj,Cj,Ej,Tj,Aj,Ij,Oj,Rj,_j,Dj,Nj,Lj,Pj,Mj,qj,Fj,jj,Bj,Hj,Uj,Gj,Wj,zj,Kj,Vj,Jj,Yj,Zj,$j,Qj,Xj,eB,tB,rB,iB,sB,nB,oB,aB,cB,lB,uB,pB,hB,dB,fB,gB,mB,yB,bB,vB,kB,xB,wB,SB,CB,EB,TB,AB,IB,OB,RB,_B,DB,NB,LB,PB,MB,qB,FB,jB,BB,HB,UB,GB,WB,zB,KB,VB,JB,YB,ZB,$B,QB,XB,eH,tH,rH,iH,sH,nH,oH,aH,cH,lH,uH,pH,hH,dH,fH,gH,mH,yH,bH,vH,kH,xH,wH,SH,CH,EH,TH,AH,IH,OH,RH,_H,DH,NH,LH,PH,MH,qH,FH,jH,BH,HH,UH,GH,WH,zH,KH,VH,JH,YH,ZH,$H,QH,XH,eU,tU,rU,iU,sU,nU,oU,aU,cU,lU,uU,pU,hU,dU,fU,gU,mU,yU,bU,vU,kU,xU,wU,SU,CU,EU,TU,AU,IU,OU,RU,_U,DU,NU,LU,PU,MU,qU,FU,jU,BU,HU,UU,GU,WU,zU,KU,VU,JU,YU,ZU,$U,QU,XU,eG,tG,rG,iG,sG,nG,oG,aG,cG,lG,uG,pG,hG,dG,fG,gG,mG,yG,bG,vG,kG,xG,wG,SG,CG,EG,TG,AG,IG,OG,RG,_G,DG,NG,LG,PG,MG,qG,FG,jG,BG,HG,UG,GG,WG,zG,KG,VG,JG,YG,ZG,$G,QG,XG,eW,tW,rW,iW,sW,nW,oW,aW,cW,lW,uW,pW,hW,dW,fW,gW,mW,yW,bW,vW,kW,xW,wW,SW,CW,EW,TW,AW,IW,OW,RW,_W,DW,NW,LW,PW,MW,qW,FW,jW,BW,HW,UW,GW,WW,zW,KW,VW,JW,YW,ZW,$W,QW,XW,ez,tz,rz,iz,sz,nz,oz,az,cz,lz,uz,pz,hz,dz,fz,gz,mz,yz,bz,vz,kz,xz,wz,Sz,Cz,Ez,Tz,Az,Iz,Oz,Rz,_z,Dz,Nz,Lz,Pz,Mz,qz,Fz,jz,Bz,Hz,Uz,Gz,Wz,zz,Kz,Vz,Jz,Yz,Zz,$z,Qz,Xz,eK,tK,rK,iK,sK,nK,oK,aK,cK,lK,uK,pK,hK,dK,fK,gK,mK,yK,bK,vK,kK,xK,wK,SK,CK,EK,TK,AK,IK,OK,RK,_K,DK,NK,LK,PK,MK,qK,FK,jK,BK,HK,UK,GK,WK,zK,KK,VK,JK,YK,ZK,$K,QK,XK,eV,tV,rV,iV,sV,nV,oV,aV,cV,lV,uV,pV,hV,dV,fV,gV,mV,yV,bV,vV,kV,xV,wV,SV,CV,EV,TV,AV,IV,OV,RV,_V,DV,NV,LV,PV,MV,qV,FV,jV,BV,HV,UV,GV,WV,zV,KV,VV,JV,YV,ZV,$V,QV,XV,eJ,tJ,rJ,iJ,sJ,nJ,oJ,aJ,cJ,lJ,uJ,pJ,hJ,dJ,fJ,gJ,mJ,yJ,bJ,vJ,kJ,xJ,wJ,SJ,CJ,EJ,TJ,AJ,IJ,OJ,RJ,_J,DJ,NJ,LJ,PJ,MJ,qJ,FJ,jJ,BJ,HJ,UJ,GJ,WJ,zJ,KJ,VJ,JJ,YJ,ZJ,$J,QJ,XJ,eY,tY,rY,iY,sY,nY,oY,aY,cY,lY,uY,pY,hY,dY,fY,gY,mY,yY,bY,vY,kY,xY,wY,SY,CY,EY,TY,AY,IY,OY,RY,_Y,DY,NY,LY,PY,MY,qY,FY,jY,BY,HY,UY,GY,WY,zY,KY,VY,JY,YY,ZY,$Y,QY,XY,eZ,tZ,rZ,iZ,sZ,nZ,oZ,aZ,cZ,lZ,uZ,pZ,hZ,dZ,fZ,gZ,mZ,yZ,bZ,vZ,kZ,xZ,wZ,SZ,CZ,EZ,TZ,AZ,IZ,OZ,RZ,_Z,DZ,NZ,LZ,PZ,MZ,qZ,FZ,jZ,BZ,HZ,UZ,GZ,WZ,zZ,KZ,VZ,JZ,YZ,ZZ,$Z,QZ,XZ,e$,t$,r$,i$,s$,n$,o$,a$,c$,l$,u$,p$,h$,d$,f$,g$,m$,y$,b$,v$,k$,x$,w$,S$,C$,E$,T$,A$,I$,O$,R_$,D$,N$,L$,P$,M$,q$,F$,j$,B$,H$,U$,G$,W$,z$,K$,V$,J$,Y$,Z$,$$,Q$,X$,eQ,tQ,rQ,iQ,sQ,nQ,oQ,aQ,cQ,lQ,uQ,pQ,hQ,dQ,fQ,gQ,mQ,yQ,bQ,vQ,kQ,xQ,wQ,SQ,CQ,EQ,TQ,AQ,IQ,OQ,RQ,_Q,DQ,NQ,LQ,PQ,MQ,qQ,FQ,jQ,BQ,HQ,UQ,GQ,WQ,zQ,KQ,VQ,JQ,YQ,ZQ,$Q,QQ,XQ,eX,tX,rX,iX,sX,nX,oX,aX,cX,lX,uX,pX,hX,dX,fX,gX,mX,yX,bX,vX,kX,xX,wX,SX,CX,EX,TX,AX,IX,OX,RX,_X,DX,NX,LX,PX,MX,qX,FX,jX,BX,HX,UX,GX,WX,zX,KX,VX,JX,YX,ZX,$X,QX,XX,e1,t1,r1,i1,s1,n1,o1,a1,c1,l1,u1,p1,h1,d1,f1,g1,m1,y1,b1,v1,k1,x1,w1,S1,C1,E1,T1,A1,I1,O1,R1,_1,D1,N1,L1,P1,M1,q1,F1,j1,B1,H1,U1,G1,W1,z1,K1,V1,J1,Y1,Z1,$1,Q1,X1,e2,t2,r2,i2,s2,n2,o2,a2,c2,l2,u2,p2,h2,d2,f2,g2,m2,y2,b2,v2,k2,x2,w2,S2,C2,E2,T2,A2,I2,O2,R2,_2,D2,N2,L2,P2,M2,q2,F2,j2,B2,H2,U2,G2,W2,z2,K2,V2,J2,Y2,Z2,$2,Q2,X2,e3,t3,r3,i3,s3,n3,o3,a3,c3,l3,u3,p3,h3,d3,f3,g3,m3,y3,b3,v3,k3,x3,w3,S3,C3,E3,T3,A3,I3,O3,R3,_3,D3,N3,L3,P3,M3,q3,F3,j3,B3,H3,U3,G3,W3,z3,K3,V3,J3,Y3,Z3,$3,Q3,X3,e4,t4,r4,i4,s4,n4,o4,a4,c4,l4,u4,p4,h4,d4,f4,g4,m4,y4,b4,v4,k4,x4,w4,S4,C4,E4,T4,A4,I4,O4,R4,_4,D4,N4,L4,P4,M4,q4,F4,j4,B4,H4,U4,G4,W4,z4,K4,V4,J4,Y4,Z4,$4,Q4,X4,e5,t5,r5,i5,s5,n5,o5,a5,c5,l5,u5,p5,h5,d5,f5,g5,m5,y5,b5,v5,k5,x5,w5,S5,C5,E5,T5,A5,I5,O5,R5,_5,D5,N5,L5,P5,M5,q5,F5,j5,B5,H5,U5,G5,W5,z5,K5,V5,J5,Y5,Z5,$5,Q5,X5,e6,t6,r6,i6,s6,n6,o6,a6,c6,l6,u6,p6,h6,d6,f6,g6,m6,y6,b6,v6,k6,x6,w6,S6,C6,E6,T6,A6,I6,O6,R6,_6,D6,N6,L6,P6,M6,q6,F6,j6,B6,H6,U6,G6,W6,z6,K6,V6,J6,Y6,Z6,$6,Q6,X6,e7,t7,r7,i7,s7,n7,o7,a7,c7,l7,u7,p7,h7,d7,f7,g7,m7,y7,b7,v7,k7,x7,w7,S7,C7,E7,T7,A7,I7,O7,R7,_7,D7,N7,L7,P7,M7,q7,F7,j7,B7,H7,U7,G7,W7,z7,K7,V7,J7,Y7,Z7,$7,Q7,X7,e8,t8,r8,i8,s8,n8,o8,a8,c8,l8,u8,p8,h8,d8,f8,g8,m8,y8,b8,v8,k8,x8,w8,S8,C8,E8,T8,A8,I8,O8,R8,_8,D8,N8,L8,P8,M8,q8,F8,j8,B8,H8,U8,G8,W8,z8,K8,V8,J8,Y8,Z8,$8,Q8,X8,e9,t9,r9,i9,s9,n9,o9,a9,c9,l9,u9,p9,h9,d9,f9,g9,m9,y9,b9,v9,k9,x9,w9,S9,C9,E9,T9,A9,I9,O9,R9,_9,D9,N9,L9,P9,M9,q9,F9,j9,B9,H9,U9,G9,W9,z9,K9,V9,J9,Y9,Z9,$9,Q9,X9,e0,t0,r0,i0,s0,n0,o0,a0,c0,l0,u0,p0,h0,d0,f0,g0,m0,y0,b0,v0,k0,x0,w0,S0,C0,E0,T0,A0,I0,O0,R0,_0,D0,N0,L0,P0,M0,q0,F0,j0,B0,H0,U0,G0,W0,z0,K0,V0,J0,Y0,Z0,$0,Q0,X0,t.prototype.parse=function(e){return this.text=e,this.index=0,this.parseValue(),this.eatWhitespace(),this.index<this.text.length?this.unexpectedEnd():this.value},t.prototype.parseValue=function(){this.eatWhitespace();var e=this.text[this.index];if(e===r)this.parseObject();else if(e===i)this.parseArray();else if(e===s)this.parseString();else if(this.isDigit(e)||e===n)this.parseNumber();else if(e===o)this.parseTrue();else if(e===a)this.parseFalse();else{if(e!==c)throw this.parseObject(),void(this.index<this.text.length&&this.text[this.index]===r||this.parseValue());this.parseNull()}},t.prototype.parseObject=function(){if(this.text[this.index]===r){if(this.index++,this.eatWhitespace(),this.value={},this.text[this.index]===l)return void this.index++;var e=!1;for(;this.index<this.text.length&&this.text[this.index]!==l;){if(e&&this.eatComma(),this.parseString(),this.eatWhitespace(),this.eatColon(),this.parseValue(),e=!0,this.text[this.index]===l)break}if(this.text[this.index]===l)this.index++;else{if(this.index<this.text.length)throw this.unexpectedCharacter();throw this.unexpectedEnd()}}},t.prototype.parseArray=function(){if(this.text[this.index]===i){if(this.index++,this.eatWhitespace(),this.value=[],this.text[this.index]===u)return void this.index++;var e=!1;for(;this.index<this.text.length&&this.text[this.index]!==u;){if(e&&this.eatComma(),this.parseValue(),e=!0,this.text[this.index]===u)break}if(this.text[this.index]===u)this.index++;else{if(this.index<this.text.length)throw this.unexpectedCharacter();throw this.unexpectedEnd()}}},t.prototype.parseString=function(){var e,t="";if(this.text[this.index]===s&&(this.index++,t=this.text[this.index],this.index++,t===p))for(;this.index<this.text.length&&this.text[this.index]!==p;)if(this.text[this.index]===h){var r=this.text.substring(this.index,this.index+2);if(r===d)t+=d,this.index+=2;else if(r===f)t+=f,this.index+=2;else if(r===g)t+=g,this.index+=2;else if(r===m)t+=m,this.index+=2;else if(r===y)t+=y,this.index+=2;else if(r===b)t+=b,this.index+=2;else if(r===v)t+=v,this.index+=2;else if(r===k){var i=this.text.substring(this.index+1,this.index+5);try{e=String.fromCharCode(parseInt(i,16))}catch(e){throw this.unexpectedCharacter()}t+=e,this.index+=5}else t+=this.text[this.index],this.index++}else t+=this.text[this.index],this.index++;else this.index<this.text.length&&this.text[this.index]===p&&(this.index++);this.value=t},t.prototype.parseNumber=function(){var e=this.index;if(this.text[this.index]===n&&this.index++,this.text[this.index]===x){if(this.index++,!this.isDigit(this.text[this.index]))throw this.unexpectedCharacter()}else for(;this.isDigit(this.text[this.index]);)this.index++;if(this.text[this.index]===w){for(this.index++;this.isDigit(this.text[this.index]);)this.index++}if(this.text[this.index]===S||this.text[this.index]===C){if(this.index++,(this.text[this.index]===E||this.text[this.index]===T)&&this.index++,!this.isDigit(this.text[this.index]))throw this.unexpectedCharacter();for(;this.isDigit(this.text[this.index]);)this.index++}var t=this.text.substring(e,this.index);this.value=parseFloat(t)},t.prototype.parseTrue=function(){this.text.substring(this.index,this.index+4)===o?(this.index+=4,this.value=!0):this.unexpectedCharacter()},t.prototype.parseFalse=function(){this.text.substring(this.index,this.index+5)===a?(this.index+=5,this.value=!1):this.unexpectedCharacter()},t.prototype.parseNull=function(){this.text.substring(this.index,this.index+4)===c?(this.index+=4,this.value=null):this.unexpectedCharacter()},t.prototype.eatWhitespace=function(){for(;this.isWhitespace(this.text[this.index]);)this.index++},t.prototype.eatComma=function(){this.text[this.index]===A?(this.index++,this.eatWhitespace()):this.text[this.index]===l||this.text[this.index]===u||(this.eatWhitespace(),this.text[this.index]===A?(this.index++,this.eatWhitespace()):this.isStartOfValue(this.text[this.index])||(this.text[this.index]===l||this.text[this.index]===u?this.unexpectedCharacter():this.missingComma()))},t.prototype.eatColon=function(){this.text[this.index]===I?this.index++:this.isStartOfValue(this.text[this.index])?this.missingColon():this.unexpectedCharacter()},t.prototype.isWhitespace=function(e){return e===O||e===R||e===_||e===D},t.prototype.isDigit=function(e){return e>=x&&e<=N},t.prototype.isStartOfValue=function(e){return this.isWhitespace(e)||e===r||e===l||e===i||e===u||e===s||this.isDigit(e)||e===n||e===o||e===a||e===c},t.prototype.unexpectedCharacter=function(){throw new Error("Unexpected character "+JSON.stringify(this.text[this.index])+" at index "+this.index)},t.prototype.unexpectedEnd=function(){throw new Error("Unexpected end of json string")},t.prototype.missingComma=function(){throw new Error("Comma missing before character "+JSON.stringify(this.text[this.index])+" at index "+this.index)},t.prototype.missingColon=function(){throw new Error("Colon missing before character "+JSON.stringify(this.text[this.index])+" at index "+this.index)},e.jsonrepair=function(e){return new t(e).parse()},Object.defineProperty(e,"__esModule",{value:!0})}));
    </script>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f8f9fa; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 1000px; margin: auto; }
        h1 { text-align: center; color: #2c3e50; }
        #json-input { width: 100%; height: 250px; padding: 15px; border: 1px solid #ced4da; border-radius: 8px; font-family: 'Courier New', Courier, monospace; font-size: 14px; box-sizing: border-box; margin-bottom: 20px; }
        #report-output { background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); min-height: 100px; border: 1px solid #dee2e6; text-align: left; }
        .placeholder { color: #adb5bd; text-align: center; font-style: italic; }
        .error { color: #dc3545; font-weight: bold; text-align: center; }
        .card { background: #fdfdfd; border: 1px solid #eee; border-radius: 6px; padding: 20px; margin-bottom: 20px; }
        .tag { display: inline-block; background-color: #e7f3ff; color: #007bff; padding: 4px 10px; border-radius: 12px; font-size: 0.9em; margin-right: 8px; margin-bottom: 8px; }
        .lyrics { background: #f3f4f6; border-left: 3px solid #60a5fa; padding: 15px; margin: 15px 0; white-space: pre-wrap; font-style: italic; word-wrap: break-word; }
        .highlight-title { font-weight: bold; color: #16a34a; }
        .highlight-text { display: block; margin-left: 20px; }
        details { background: #fafafa; border-radius: 4px; padding: 10px; margin-top: 10px; border: 1px solid #eee; }
        summary { font-weight: bold; cursor: pointer; color: #3498db; }
    </style>
</head>
<body>
    <div class="container">
        <h1>音乐分析报告生成器</h1>
        <p style="text-align: center;">请在下方粘贴JSON内容 (支持从CSV/Excel直接复制)，报告将自动实时生成。</p>
        <textarea id="json-input" placeholder="在这里粘贴你的内容..."></textarea>
        <div id="report-output">
            <p class="placeholder">报告将在此处显示</p>
        </div>
    </div>
    <script>
        const jsonInput = document.getElementById('json-input');
        const reportOutput = document.getElementById('report-output');

        jsonInput.addEventListener('input', function() {
            let rawString = this.value;
            if (!rawString.trim()) {
                reportOutput.innerHTML = '<p class="placeholder">报告将在此处显示</p>';
                return;
            }
            try {
                // --- 核心处理流程 ---

                // 1. CSV净化：处理从CSV/Excel粘贴带来的格式污染
                let cleanedString = rawString.trim();
                //  1a. 移除最外层的双引号
                if (cleanedString.startsWith('"') && cleanedString.endsWith('"')) {
                    cleanedString = cleanedString.substring(1, cleanedString.length - 1);
                }
                //  1b. 将CSV转义的双引号 ("") 替换回标准的单个双引号 (")
                cleanedString = cleanedString.replace(/""/g, '"');

                // 2. JSON修复：使用内联的jsonrepair库修复其他可能的语法错误
                const repairedString = jsonrepair.jsonrepair(cleanedString);
                
                // 3. JSON解析：将修复后的字符串解析为JavaScript对象
                let data = JSON.parse(repairedString);

                // 4. 兼容性处理：如果数据包含在 music_comprehensive_caption 键下，则提取它
                if (data.music_comprehensive_caption) {
                    data = data.music_comprehensive_caption;
                }

                // 5. 生成并显示报告
                reportOutput.innerHTML = generateReportHtml(data);

            } catch (error) {
                // 如果任何步骤失败，显示清晰的错误信息
                reportOutput.innerHTML = `<p class="error">内容无法解析，请检查格式: ${error.message}</p>`;
            }
        });

        // --- 报告生成函数 (保持不变) ---
        function generateReportHtml(data) {
            const globalDim = data.global_dimension || {};
            const sectionDim = data.section_dimension || [];
            let html = '';
            html += "<h2>核心信息</h2><div class='card'>";
            const factKeywords = globalDim.fact_keywords || {};
            for (const [key, val] of Object.entries(factKeywords)) { html += `<span class='tag'><strong>${formatKey(key)}:</strong> ${val}</span>`; }
            html += "</div>";
            html += "<h2>全局维度分析</h2><div class='card'>";
            const globalDesc = (globalDim.description || '(无)').replace(/\[(.*?)\]/g, '<strong>[$1]</strong>');
            html += `<h3>综合描述</h3><p>${globalDesc}</p>`;
            const highlights = globalDim.highlights || {};
            if (Object.keys(highlights).length > 0) {
                html += "<h3>亮点</h3>";
                for (const [key, val] of Object.entries(highlights)) { html += `<p><span class='highlight-title'>${key}:</span> <span class='highlight-text'>${val}</span></p>`; }
            }
            html += "</div>";
            html += "<h2>段落维度分析</h2>";
            for (const section of sectionDim) {
                html += `<div class='card'><h3>${section.id || ''} <small>(${section.timestamp || ''})</small></h3>`;
                html += `<p><strong>描述:</strong> ${section.description || '(无)'}</p>`;
                const lyrics = section.lyrics || '';
                if (lyrics && lyrics !== '(Instrumental)') { html += `<div class='lyrics'>${lyrics.replace(/\n/g, '<br>')}</div>`; }
                const keywords = section.keywords || {};
                if (Object.keys(keywords).length > 0) {
                    html += "<details><summary>显示/隐藏 关键词</summary><ul>";
                    for (const [k, v] of Object.entries(keywords)) { html += `<li><strong>${formatKey(k)}:</strong> ${v}</li>`; }
                    html += "</ul></details>";
                }
                const secHighlights = section.highlights || {};
                if (Object.keys(secHighlights).length > 0) {
                    html += "<details open><summary>显示/隐藏 亮点</summary>";
                    for (const [key, val] of Object.entries(secHighlights)) { html += `<p><span class='highlight-title'>${key}:</span> <span class='highlight-text'>${val}</span></p>`; }
                    html += "</details>";
                }
                html += "</div>";
            }
            return html;
        }
        function formatKey(key) { return key.replace(/_/g, ' ').replace(/\b\w/g, char => char.toUpperCase()); }
    </script>
</body>
</html>
